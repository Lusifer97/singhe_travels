<?phpclass Auth extends Model{    function __construct()    {        parent::__construct();           }    function authentication()    {               //        echo "auth called";        if (Session::isset_session(LOGIN_CONFIG['AUTH_PREFIX'] . 'adminid')) {            $id = Hash::decrypt(Session::get(LOGIN_CONFIG['AUTH_PREFIX'] . 'adminid'));            $login_token = Hash::decrypt(Session::get(LOGIN_CONFIG['AUTH_PREFIX'] . 'adminlogin_token'));            //            var_dump($login_token);            if ($id != '' && $login_token != '' && !empty($login_token)) {                $result = $this->check_login_token($id, $login_token);                if (!empty($result)) {                    $this->user = $this->get_user(Hash::decrypt(Session::get(LOGIN_CONFIG['AUTH_PREFIX'] . 'adminid')));                    return $this->user;                } else {                    header('Location: ' . URL);                }            }        } else {            header('Location: ' . URL);        }    }    function get_user($id)    {        $result = $this->db->select(array(            'table' => LOGIN_CONFIG['TABLE'],            'column' => '*',            'where' => 'id = :id',            'data' => array(                'id' => $id            )        ));        $result = $this->db->select(array(            'table' => LOGIN_CONFIG['TABLE'],            'column' => '*',            'where' => 'id = :id and is_deleted = :is_deleted',            'data' => array(                'id' => $id,                'is_deleted' => '0'            )        ));        return $result[0];    }    function check_login_token($id, $login_token)    {        $result = $this->db->select(array(            'table' => LOGIN_CONFIG['TABLE'],            'column' => '*',            'where' => 'id = :id and token = :token and is_active = :is_active',            'data' => array(                'is_active' => '1', 'id' => $id, 'token' => $login_token            )        ));        return $result;    }}